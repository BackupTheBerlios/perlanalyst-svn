#!/usr/bin/perl

use Perl::Analysis::Static::Log qw(set_debug debug);
use Perl::Analysis::Static::Database qw(set_database_file
create_tables connect_to_database);
use Perl::Analysis::Static::Plugins qw(load_plugins);
use Perl::Analysis::Static::File qw(add_directory);
use Perl::Analysis::Static::Analysis qw(analyze);

unless ($ARGV[0]) {
	die 'Which directory am I supposed to look in?';
}

# yes, we want debugging output
set_debug();

set_database_file("$ENV{HOME}/analysis.sqlite");

connect_to_database();

load_plugins();

create_tables();

# add a directory of Perl documents
add_directory($ARGV[0]);

# analyze all files in the database
analyze();
